<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link href=" https://cdn.jsdelivr.net/npm/@fontsource/monaspace-krypton@5.1.0/index.min.css " rel="stylesheet"><link rel="stylesheet" href="https://babal.dev/assets/css/syntax.css"><link rel="stylesheet" href="https://babal.dev/assets/css/table_of_content.css"><link rel="preconnect" href="https://cdnjs.cloudflare.com"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><title> Testing Controller in AngularJS - A0__oN</title><link rel="shortcut icon" href="https://babal.dev/favicon.png"><link rel="alternate" type="application/atom+xml" title="A0__oN" href="https://babal.dev/atom.xml"><link rel="alternate" type="application/json" title="A0__oN" href="https://babal.dev/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="https://babal.dev/sitemap.xml" /><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Play:wght@400;700&family=Source+Code+Pro:ital,wght@0,200;0,300;0,400;0,600;0,700;0,900;1,300;1,400;1,500;1,600;1,700;1,900&display=swap" rel="stylesheet"><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}html{font-size:15px}#theme-toggle{opacity:0.65;position:relative;border-radius:5px;height:25px;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;transition:opacity 0.3s ease 0s;border:none;outline:none;background:none;cursor:pointer;padding:0px;appearance:none;transform:scale(0.8)}html,html[data-theme="light"]{--text-font: Play;--source-code-font: "Monaspace Krypton";--very-light-text-color: rgb(222, 222, 222);--light-text-color: rgb(89, 183, 255);--medium-text-color: #555;--main-text-color: #333;--highlight-text-color: #6cb4a0;--dark-text-color: #393e46;--link-color: rgb(50, 87, 209);--code-bg-color: rgb(245, 245, 245);background-color:#fff}html #theme-toggle div,html[data-theme="light"] #theme-toggle div{position:relative;width:24px;height:24px;border-radius:50%;border:none;background-color:var(--theme-ui-colors-transparent, transparent);transform:scale(1);transition:all 0.45s ease 0s;overflow:hidden;box-shadow:inset 8px -8px 0px 0px var(--theme-ui-colors-toggleIcon, #2d3748)}html #theme-toggle div::before,html[data-theme="light"] #theme-toggle div::before{content:"";position:absolute;right:-9px;top:-9px;height:24px;width:24px;border:none;border-radius:50%;transform:translate(0px, 0px);opacity:1;transition:transform 0.45s ease 0s}html #theme-toggle div::after,html[data-theme="light"] #theme-toggle div::after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0px 0px -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--theme-ui-colors-toggleIcon, #2d3748),0 23px 0 var(--theme-ui-colors-toggleIcon, #2d3748),23px 0 0 var(--theme-ui-colors-toggleIcon, #2d3748),-23px 0 0 var(--theme-ui-colors-toggleIcon, #2d3748),15px 15px 0 var(--theme-ui-colors-toggleIcon, #2d3748),-15px 15px 0 var(--theme-ui-colors-toggleIcon, #2d3748),15px -15px 0 var(--theme-ui-colors-toggleIcon, #2d3748),-15px -15px 0 var(--theme-ui-colors-toggleIcon, #2d3748);transform:scale(0);transition:all 0.35s ease 0s}html[data-theme="dark"]{--text-font: Play;--source-code-font: "Monaspace Krypton";--very-light-text-color: #EEE;--light-text-color: #c4bbf0;--medium-text-color: #52057b;--main-text-color: #EAEAEA;--highlight-text-color: #6cb4a0;--dark-text-color: rgb(36, 38, 42);--link-color: rgb(255, 89, 125);--code-bg-color: rgb(36, 38, 42);background-color:#131418}html[data-theme="dark"] #theme-toggle div{position:relative;width:24px;height:24px;border-radius:50%;border:4px solid var(--theme-ui-colors-toggleIcon, #cbd5e0);background-color:var(--theme-ui-colors-toggleIcon, #cbd5e0);transform:scale(0.55);transition:all 0.45s ease 0s;overflow:visible;box-shadow:none}html[data-theme="dark"] #theme-toggle div::before{content:"";position:absolute;right:-9px;top:-9px;height:24px;width:24px;border:2px solid var(--theme-ui-colors-toggleIcon, #cbd5e0);border-radius:50%;transform:translate(14px, -14px);opacity:0;transition:transform 0.45s ease 0s}html[data-theme="dark"] #theme-toggle div::after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0px 0px -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),0 23px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),23px 0 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),-23px 0 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),15px 15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),-15px 15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),15px -15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),-15px -15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0);transform:scale(1);transition:all 0.35s ease 0s}body{font-family:var(--text-font),monospace;text-rendering:optimizeLegibility;line-height:1.75;color:var(--main-text-color)}a{color:var(--link-color);text-decoration:none}.post p{margin:1rem 0}.meta{margin:1.4rem 0}code,pre{background:var(--code-bg-color);margin:0 -27px;border-width:1px}code{font-family:var(--source-code-font),monospace;font-size:13px;margin:unset;padding:0.1rem;color:var(--highlight-text-color)}pre code{background-color:unset;color:unset}pre{border-width:3px;padding:0.8rem;white-space:pre-wrap;border-style:none none none solid;border-color:var(--light-text-color)}img{max-width:100%}hr{background:var(--light-text-color);height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:0.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem 0}section{margin-top:5.5rem}blockquote{font-style:italic;border-left:5px solid var(--dark-text-color);padding-left:1rem}h1{color:var(--main-text-color);text-transform:uppercase;font-size:2rem;font-weight:bold;margin-bottom:1.5rem}h2,h3,h4,h5{font-weight:bold;margin-bottom:1.5rem;font-size:2rem}h2{font-size:1.8rem}h3{font-size:1.6rem}h4{font-size:1.4rem}h5{font-size:1.2rem}h6{font-size:1rem}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:0.5rem}.posts>h3{font-weight:500}.post ul{margin:0px;margin:0px 0px 10px 10px}.post ol{margin:0px;margin:0px 0px 10px 15px}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:0.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:bold}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}time{color:var(--main-text-color)}.post>h1.title{font-size:x-large;margin-top:0;margin-bottom:0}.post>time{margin-bottom:0;margin-top:3rem}.highlight{margin:0px}main{display:flex;max-width:55rem;margin:-5rem auto 0;padding:2.4rem 2rem;flex-direction:column}.flex-row-between{display:flex;flex-direction:row;justify-content:space-between}.social-footer{padding:1rem;display:flex;justify-content:center;position:initial}.social-footer .social-footer-icons .fa{font-size:1.3rem;color:#a9a9a9}.social-footer .social-footer-icons .fa:hover{color:dimgray;transition:color 0.3s ease-in}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:0.5rem}main{padding:0 2rem}}section{flex-grow:999;display:flex;flex-direction:column}figcaption{font-size:smaller}.bio{margin-bottom:3rem}section.posts{margin-top:1rem}section.notes{margin-top:0;margin-bottom:2rem}::selection{background-color:#fffba0;color:#333}.search-article{position:relative}.search-article label[for="search-input"]{position:relative;top:-10px;left:11px}.search-article input[type="search"]{top:-1rem;left:0;border:0;width:100%;height:30px;outline:none;position:absolute;border-radius:5px;padding:10px 10px 10px 35px;color:var(--main-text-color);-webkit-appearance:none;background-color:rgba(128,128,128,0.1);border:1px solid rgba(128,128,128,0.1)}.search-article input[type="search"]::-webkit-input-placeholder{color:#808080}.search-article input[type="search"]::-webkit-search-decoration,.search-article input[type="search"]::-webkit-search-results-decoration{display:none}#search-results{text-align:center}#search-results li{text-align:center}#search-results li::before{content:"â€º";display:inline-block;margin-left:-1.3em;width:1.3em;color:var(--main-text-color)}.post-nav{display:flex;position:relative;margin-top:0;border-top:2px solid var(--light-text-color);line-height:1.4}.post-nav .post-nav-item{border-bottom:0;padding-bottom:10px;width:50%;padding-top:10px;text-decoration:none;box-sizing:border-box}.post-nav .post-nav-item .post-title{color:var(--main-text-color)}.post-nav .post-nav-item:hover .post-title,.post-nav .post-nav-item:focus .post-title{color:var(--link-color);opacity:0.9}.post-nav .post-nav-item .nav-arrow{font-size:17px;color:var(--main-text-color);margin-bottom:3px;font-weight:bold}.post-nav .post-nav-item:nth-child(odd){padding-left:0;padding-right:20px}.post-nav .post-nav-item:nth-child(even){text-align:right;padding-right:0;padding-left:20px}.tags ul{list-style:none;display:grid;grid-template-columns:auto auto auto auto auto auto;grid-template-rows:auto auto auto auto}.tags li{white-space:normal;text-overflow:ellipsis}.timeline{position:center;margin:-6em auto;padding:1px;list-style-type:none;width:100%}.timeline:before{position:absolute;left:50%;content:' ';display:block;width:6px;margin-left:-3px;background:var(--light-text-color);z-index:5;height:150%}.timeline li{padding:2em 0}.timeline li::after{content:"";display:block;clear:both;visibility:hidden}.direction-l{position:relative;float:none;width:100%;text-align:center}.direction-l .flag{color:#333;box-shadow:-1px 1px 1px rgba(0,0,0,0.52)}.direction-l .time-wrapper{float:none}.direction-r{position:relative;float:none;width:100%;text-align:center}.direction-r .flag{color:#333;box-shadow:1px 1px 1px rgba(0,0,0,0.52)}.direction-r .time-wrapper{float:none}.flag-wrapper{position:relative;display:inline-block;text-align:center}.flag-wrapper .flag{position:relative;display:inline;padding:6px 10px;border-radius:5px;font-weight:600;text-align:left;background:#fff;z-index:15}.time-wrapper{line-height:1em;font-size:0.66666em;color:var(--link-color);vertical-align:middle;display:block;position:relative;margin:4px 0 0 0;z-index:14}.time-wrapper .time{display:inline-block;padding:4px 6px;background:#f8f8f8}.desc{font-size:0.9em;line-height:1.5em;position:relative;margin:1em 1em 0 1em;padding:1em;background:var(--code-bg-color);box-shadow:0 0 1px rgba(0,0,0,0.2);z-index:15}.desc a{color:var(--link-color);text-decoration:none}.desc a:hover{text-decoration:underline}.desc ul{list-style:circle}.desc ul li{padding:0;margin-left:20px;text-align:left}.pagination{margin-top:3em;display:flex;justify-content:space-between}.text-left-align{text-align:left}pre{white-space:pre;overflow-x:scroll}</style></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-TAG"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-TAG'); </script><body><main><div class="table-of-contents-btn-wrapper"> <button class="table-of-contents-btn" onclick="toggleTableOfContents()"> <i class="fa fa-bars"></i> </button></div><section class="post"><div class="flex-row-between"> <a href="https://babal.dev/">Â« back</a> <button title="Change theme" id="theme-toggle" onclick="modeSwitcher()"><div></div></button> <span class="table-of-contents-btn-spacer"></span></div><time datetime="2016-11-30T00:00:00-05:00">Nov 30, 2016 - 6 ' read </time><h1 class="title"> Testing Controller in AngularJS</h1><span class="meta"> Tags:&nbsp; <a href="https://babal.dev/tag/javascript">javascript</a>, <a href="https://babal.dev/tag/angular">angular</a></span><div class="table-of-content-wrapper"><nav role="navigation"><ul class="summary"><li class="table-of-contents-label">Table Of Contents</li><li> <a href="/2016/11/30/angular-testing-controller"> Testing Controller in AngularJS </a></li></ul></nav></div><p>In <a href="https://amantuladhar.github.io/blog/2016-11-23-unit-testing-angular-1-part-1/">Part 1</a> <a href="https://atuladhar-aman.github.io/blog/2016-11-24-integrate-karma-with-jasmine/">Part 2</a> and <a href="https://atuladhar-aman.github.io/blog/2016-11-25-using-gulp-to-run-karma/">Part 3</a> of this article we didnâ€™t talk a lot about testing. Those 3 parts were more focused on <strong>configuration</strong> required to do testing.</p><p>In this article Iâ€™ll show you how we can test simple AngularJS <strong><code class="language-plaintext highlighter-rouge">Controllers</code></strong>.</p><p>Hereâ€™s the folder structure that we are going to use.</p><p><img src="/assets/blog/2016-11-30-angular-testing-simple-controller/angular-app-structure.png" width="40%" style="padding-left: 20%" /></p><p><a href="https://gist.github.com/atuladhar-aman/47a2ad4f53cba8977be3943ec883c3ff">Here are content of those file if you want to follow along</a></p><p>We are going to write our test on <code class="language-plaintext highlighter-rouge">TodoControllerSpec.js</code>. Before writing the test letâ€™s look at <code class="language-plaintext highlighter-rouge">todo.controller.js</code></p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">angular</span><span class="p">)</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">use strict</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">angular</span>
        <span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="dl">'</span><span class="s1">app</span><span class="dl">'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="dl">'</span><span class="s1">TodoController</span><span class="dl">'</span><span class="p">,</span> <span class="nx">TodoController</span><span class="p">);</span>

    <span class="nx">TodoController</span><span class="p">.</span><span class="nx">$inject</span> <span class="o">=</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$scope</span><span class="dl">'</span><span class="p">];</span>

    <span class="kd">function</span> <span class="nx">TodoController</span><span class="p">(</span><span class="nx">$scope</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span><span class="dl">'</span><span class="s1">title</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">First Todo</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">done</span><span class="dl">'</span><span class="p">:</span> <span class="kc">false</span><span class="p">}</span>
        <span class="p">];</span>
        <span class="nx">$scope</span><span class="p">.</span><span class="nx">add</span> <span class="o">=</span> <span class="nx">add</span><span class="p">;</span>
        <span class="nx">$scope</span><span class="p">.</span><span class="nx">clearCompleted</span> <span class="o">=</span> <span class="nx">clearCompleted</span><span class="p">;</span>

        <span class="c1">//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>

        <span class="kd">function</span> <span class="nx">add</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">unshift</span><span class="p">({</span><span class="dl">'</span><span class="s1">title</span><span class="dl">'</span><span class="p">:</span> <span class="nx">$scope</span><span class="p">.</span><span class="nx">newTodo</span><span class="p">,</span> <span class="dl">'</span><span class="s1">done</span><span class="dl">'</span><span class="p">:</span> <span class="kc">false</span><span class="p">});</span>
            <span class="nx">$scope</span><span class="p">.</span><span class="nx">newTodo</span> <span class="o">=</span> <span class="dl">""</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kd">function</span> <span class="nx">clearCompleted</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span> <span class="o">=</span> <span class="nx">$scope</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="o">!</span><span class="nx">todo</span><span class="p">.</span><span class="nx">done</span><span class="p">;</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="p">})(</span><span class="nx">angular</span><span class="p">);</span>
</code></pre></div></div><p>If you look at above code snippet carefully you can see that the controller has convenience method to <code class="language-plaintext highlighter-rouge">add()</code> and <code class="language-plaintext highlighter-rouge">clearCompleted()</code> to add the Todo and Clear the completed Todo.</p><p>Since we are going to write the <code class="language-plaintext highlighter-rouge">unit test</code> we can ignore the <strong>HTML</strong> file and focus on business logic.</p><p>Open <code class="language-plaintext highlighter-rouge">TodoControllerSpec.js</code> and create the suite by using <code class="language-plaintext highlighter-rouge">describe()</code>. <a href="https://gist.github.com/atuladhar-aman/75b77a45b42666b963a654b27cc6b686">Hereâ€™s the full content</a> of <code class="language-plaintext highlighter-rouge">TodoControllerSpec.js</code> if you want to peek at it.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">Test for TodoController</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>

<span class="p">});</span>
</code></pre></div></div><p>Now we need to initialize the <code class="language-plaintext highlighter-rouge">module</code> we can do that by using <code class="language-plaintext highlighter-rouge">module</code> function.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">Test for TodoController</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">beforeEach</span><span class="p">(</span><span class="nx">angular</span><span class="p">.</span><span class="nx">mock</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="dl">'</span><span class="s1">app</span><span class="dl">'</span><span class="p">));</span>
<span class="p">});</span>
</code></pre></div></div><p>Now that module is loaded we need to resolve reference of <code class="language-plaintext highlighter-rouge">$controller</code> service we can do that by using <code class="language-plaintext highlighter-rouge">inject()</code></p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">Test for TodoController</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">beforeEach</span><span class="p">(</span><span class="nx">angular</span><span class="p">.</span><span class="nx">mock</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="dl">'</span><span class="s1">app</span><span class="dl">'</span><span class="p">));</span>

    <span class="kd">var</span> <span class="nx">$controller</span><span class="p">;</span>

    <span class="nx">beforeEach</span><span class="p">(</span><span class="nx">angular</span><span class="p">.</span><span class="nx">mock</span><span class="p">.</span><span class="nx">inject</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">_$controller_</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$controller</span> <span class="o">=</span> <span class="nx">_$controller_</span><span class="p">;</span>
    <span class="p">}));</span>
<span class="p">});</span>
</code></pre></div></div><p>Now we have reference of <code class="language-plaintext highlighter-rouge">$controller</code> service which can be used to get initialize our <code class="language-plaintext highlighter-rouge">TodoController</code>.</p><p>First of all letâ€™s create the inner suite to test the <code class="language-plaintext highlighter-rouge">add()</code> functionality of our controller.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">Test for TodoController</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">beforeEach</span><span class="p">(</span><span class="nx">angular</span><span class="p">.</span><span class="nx">mock</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="dl">'</span><span class="s1">app</span><span class="dl">'</span><span class="p">));</span>

    <span class="kd">var</span> <span class="nx">$controller</span><span class="p">;</span>

    <span class="nx">beforeEach</span><span class="p">(</span><span class="nx">angular</span><span class="p">.</span><span class="nx">mock</span><span class="p">.</span><span class="nx">inject</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">_$controller_</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$controller</span> <span class="o">=</span> <span class="nx">_$controller_</span><span class="p">;</span>
    <span class="p">}));</span>

    <span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">Test add functionality of Controller</span><span class="dl">'</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>

    <span class="p">});</span>
<span class="p">});</span>
</code></pre></div></div><p>Inside of new suite we will write some unit test using <code class="language-plaintext highlighter-rouge">it()</code>. On each on every test we need our <code class="language-plaintext highlighter-rouge">TodoController</code> so this is a good candidate for using <code class="language-plaintext highlighter-rouge">beforeEach()</code>. Letâ€™s initialize <code class="language-plaintext highlighter-rouge">TodoController</code>.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">Test add functionality of Controller</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">controller</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">scope</span><span class="p">;</span>

        <span class="nx">beforeEach</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">scope</span> <span class="o">=</span> <span class="p">{};</span>
            <span class="nx">controller</span> <span class="o">=</span> <span class="nx">$controller</span><span class="p">(</span><span class="dl">'</span><span class="s1">TodoController</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
                <span class="na">$scope</span><span class="p">:</span> <span class="nx">scope</span>
            <span class="p">});</span>
        <span class="p">});</span>

<span class="p">});</span>
</code></pre></div></div><p>To initialize the <code class="language-plaintext highlighter-rouge">TodoController</code> we use <code class="language-plaintext highlighter-rouge">$controller</code> service. First argument <code class="language-plaintext highlighter-rouge">$controller</code> accepts is the controller name.</p><p>Second arguments on the curly braces are the dependencies that the controller has. I know I told you that we will be testing the controller that doesnâ€™t have any dependencies. But relax it is just <code class="language-plaintext highlighter-rouge">$scope</code>.</p><p>We are ready to write some unit tests. If you looked at the code you will see that we have default todo. So when our app starts there must be atleast one todo in the list. Letâ€™s check that with some expectation.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">Test add functionality of Controller</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">controller</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">scope</span><span class="p">;</span>

        <span class="nx">beforeEach</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">scope</span> <span class="o">=</span> <span class="p">{};</span>
            <span class="nx">controller</span> <span class="o">=</span> <span class="nx">$controller</span><span class="p">(</span><span class="dl">'</span><span class="s1">TodoController</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
                <span class="na">$scope</span><span class="p">:</span> <span class="nx">scope</span>
            <span class="p">});</span>
        <span class="p">});</span>

        <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">Should have 1 todo at first</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">expect</span><span class="p">(</span><span class="nx">scope</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">});</span>

    <span class="p">});</span>
</code></pre></div></div><p>In above test we are expecting that there must be exactly 1 todo on the <code class="language-plaintext highlighter-rouge">scope</code>.</p><p>Letâ€™s add some more test for <code class="language-plaintext highlighter-rouge">add</code> behaviour.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">Should add new Todo when click go</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">scope</span><span class="p">.</span><span class="nx">newTodo</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Second Todo</span><span class="dl">"</span><span class="p">;</span>
    <span class="nx">scope</span><span class="p">.</span><span class="nx">add</span><span class="p">();</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">scope</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">Should add new todo at top of list</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">scope</span><span class="p">.</span><span class="nx">newTodo</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Second Todo</span><span class="dl">"</span><span class="p">;</span>
    <span class="nx">scope</span><span class="p">.</span><span class="nx">add</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">addedTodo</span> <span class="o">=</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">todos</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">addedTodo</span><span class="p">.</span><span class="nx">title</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="dl">'</span><span class="s1">Second Todo</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">addedTodo</span><span class="p">.</span><span class="nx">done</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">Should Clear scope.newTodo after add()</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">scope</span><span class="p">.</span><span class="nx">newTodo</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Second Todo</span><span class="dl">"</span><span class="p">;</span>
    <span class="nx">scope</span><span class="p">.</span><span class="nx">add</span><span class="p">();</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">scope</span><span class="p">.</span><span class="nx">newTodo</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="dl">""</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div><p>The first test adds the new todo and checks the length of todos and see if its incremented by 1 i.e 2 for us.</p><p>Second one also adds the new todo but it checks to see if todo is added in top. Since we are using <code class="language-plaintext highlighter-rouge">unshift</code> it should add todo on top of the list.</p><p>Third one simply checks if <code class="language-plaintext highlighter-rouge">newTodo</code> properties is cleared after todo was added.</p><p>Like wise you can create the test to check the behaviour of <code class="language-plaintext highlighter-rouge">clearCompleted</code>. Hereâ€™s how I wrote the test</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">Test should clear completed todos</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

        <span class="kd">var</span> <span class="nx">controller</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">scope</span><span class="p">;</span>

        <span class="nx">beforeEach</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">scope</span> <span class="o">=</span> <span class="p">{};</span>
            <span class="nx">scope</span><span class="p">.</span><span class="nx">todos</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="dl">'</span><span class="s1">title</span><span class="dl">'</span><span class="p">:</span> <span class="dl">"</span><span class="s2">One</span><span class="dl">"</span><span class="p">,</span>
                    <span class="dl">'</span><span class="s1">done</span><span class="dl">'</span><span class="p">:</span> <span class="kc">false</span>
                <span class="p">},</span> <span class="p">{</span>
                    <span class="dl">'</span><span class="s1">title</span><span class="dl">'</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Two</span><span class="dl">"</span><span class="p">,</span>
                    <span class="dl">'</span><span class="s1">done</span><span class="dl">'</span><span class="p">:</span> <span class="kc">true</span>
                <span class="p">},</span> <span class="p">{</span>
                    <span class="dl">'</span><span class="s1">title</span><span class="dl">'</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Three</span><span class="dl">"</span><span class="p">,</span>
                    <span class="dl">'</span><span class="s1">done</span><span class="dl">'</span><span class="p">:</span> <span class="kc">true</span>
                <span class="p">}</span>
            <span class="p">];</span>
            <span class="nx">controller</span> <span class="o">=</span> <span class="nx">$controller</span><span class="p">(</span><span class="dl">'</span><span class="s1">TodoController</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
                <span class="na">$scope</span><span class="p">:</span> <span class="nx">scope</span>
            <span class="p">});</span>
        <span class="p">});</span>

        <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">Should clear completed todos</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">scope</span><span class="p">.</span><span class="nx">clearCompleted</span><span class="p">();</span>
            <span class="nx">expect</span><span class="p">(</span><span class="nx">scope</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">});</span>

        <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">Should clear completed todos</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">scope</span><span class="p">.</span><span class="nx">clearCompleted</span><span class="p">();</span>
            <span class="kd">var</span> <span class="nx">remainingItem</span> <span class="o">=</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">todos</span><span class="p">;</span>

            <span class="nx">remainingItem</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">expect</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">done</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">});</span>

    <span class="p">});</span>
</code></pre></div></div><p>To run the test you can use <code class="language-plaintext highlighter-rouge">gulp test</code>. You can see the result on terminal.</p><p>In this post you got familier with basic unit testing capabilities for an angular controller. We will see some more advance angular testing using mock services in next part of this series. Until we meet again. GOOD BYE !!</p></section><section><nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/2016/11/25/using-gulp-to-run-karma"><div class="nav-arrow">Previous</div><span class="post-title">Using Gulp to Start Karma</span> </a> <a class="post-nav-item post-nav-next" href="/2016/12/24/angular-testing-controller-with-dependency"><div class="nav-arrow">Next</div><span class="post-title">Testing Controller (with Dependencies) in AngularJS</span> </a></nav></section><div id="disqus_thread" class="article-comments"></div><script> (function () { var d = document, s = d.createElement('script'); s.src = 'https://a0on.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <script> function toggleTableOfContents() { var el = document.getElementsByClassName('post')[0]; if (el.classList.contains('with-summary')) { el.classList.remove('with-summary'); } else { el.classList.add("with-summary"); } } </script></main><script> function setTheme(theme) { if (theme === "dark") { document.documentElement.setAttribute('data-theme', 'dark'); window.localStorage.setItem('theme', 'dark'); document.getElementById("theme-toggle").classList.add('sun'); document.getElementById("theme-toggle").classList.remove('moon'); } else { document.documentElement.setAttribute('data-theme', 'light'); window.localStorage.setItem('theme', 'light'); document.getElementById("theme-toggle").classList.add('moon'); document.getElementById("theme-toggle").classList.remove('sun'); } } let theme = localStorage.getItem('theme'); theme = theme || (window.matchMedia ? window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light' : 'light'); setTheme(theme); function modeSwitcher() { let currentMode = document.documentElement.getAttribute('data-theme'); if (currentMode === "dark") { setTheme('light'); } else { setTheme('dark'); } } </script></body><footer class="social-footer"><div class="social-footer-icons"> <a href="https://github.com/amantuladhar" title="Github profile, nothing much there, yet" target="_blank" rel="noopener noreferrer"><i class="fa fa-github" aria-hidden="true"></i></a> <a href="https://babal.dev/atom.xml" title="Feed RSS" target="_blank" rel="noopener noreferrer"><i class="fa fa-rss" aria-hidden="true"></i></a></div></footer></html>
